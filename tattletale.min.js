/**
 * Tattletale
 * A UMD module for sending console logs over XHR for server-side processing.
 * 
 * @author Vimeo, LLC
 * @version 0.2.0
 * @license Apache-2.0
 */

!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof module&&module.exports?module.exports=b():a.Tattletale=b()}(this,function(){"use strict";function a(a,b){var c=this;if("string"!=typeof a)throw new Error("Tattletale instances require a URL for log submission over XHR.");c.url=a,c.request_data="object"==typeof b?b:{},c.logs=[]}function b(a,c){var d,e,f,g,h,i=[],j={};for(d in a)if(a.hasOwnProperty(d)){switch(e=a[d],c&&(d=c+"["+d+"]"),Object.prototype.toString.call(e)){case"[object Object]":f=b(e,d);break;case"[object Array]":for(g=0,h=e.length;g<h;g++)j[g]=e[g];f=b(j,d);break;default:f=d+"="+encodeURIComponent(e)}null!==e&&i.push(f)}return i.join("&")}return a.prototype={log:function(){var a,b,c,d,e=this.logs,f="",g=arguments.length;if(0!==g){for(a=[].slice.call(arguments),b=0;b<g;b++)c=a[b],d=typeof c,f+="string"===d||"number"===d||"boolean"===d?c:"[Object object]",b<g-1&&(f+=", ");e.length>100&&e.splice(0,1),e.push(f),void 0!==window.console&&"function"==typeof window.console.log&&window.console.log.apply(window.console,arguments)}},empty:function(){this.logs=[]},send:function(a){var c=this,d=new XMLHttpRequest,e=null;c.request_data.console_logs=c.logs,e=b(c.request_data),c.empty(),d.onreadystatechange=function(){4===d.readyState&&"function"==typeof a&&a()},d.open("POST",c.url,!0),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.setRequestHeader("Content-type","application/x-www-form-urlencoded"),d.send(e)}},a});